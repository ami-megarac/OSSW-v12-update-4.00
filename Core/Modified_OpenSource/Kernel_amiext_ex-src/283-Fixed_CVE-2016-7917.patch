--- linux_patch281/net/netfilter/nfnetlink.c	2020-03-23 14:39:49.130454721 +0800
+++ linux/net/netfilter/nfnetlink.c	2020-03-23 16:13:28.475736930 +0800
@@ -265,10 +265,12 @@
 		nlh = nlmsg_hdr(skb);
 		err = 0;
 
-		if (nlh->nlmsg_len < NLMSG_HDRLEN) {
-			err = -EINVAL;
-			goto ack;
-		}
+		if (nlh->nlmsg_len < NLMSG_HDRLEN ||
+		    skb->len < nlh->nlmsg_len ||
+		    nlmsg_len(nlh) < sizeof(struct nfgenmsg)) {
+			success = false;
+			goto done;
+ 		}
 
 		/* Only requests are handled by the kernel */
 		if (!(nlh->nlmsg_flags & NLM_F_REQUEST)) {
