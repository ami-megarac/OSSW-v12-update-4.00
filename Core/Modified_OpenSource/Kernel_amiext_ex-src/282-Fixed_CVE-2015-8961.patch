--- linux_patch281/fs/ext4/ext4_jbd2.c	2020-03-23 14:42:05.246504093 +0800
+++ linux/fs/ext4/ext4_jbd2.c	2020-03-23 15:32:35.293759498 +0800
@@ -87,8 +87,12 @@
 		ext4_put_nojournal(handle);
 		return 0;
 	}
-	sb = handle->h_transaction->t_journal->j_private;
 	err = handle->h_err;
+ 	if (!handle->h_transaction) {
+		rc = jbd2_journal_stop(handle);
+		return err ? err : rc;
+ 	}
+	sb = handle->h_transaction->t_journal->j_private;
 	rc = jbd2_journal_stop(handle);
 
 	if (!err)
