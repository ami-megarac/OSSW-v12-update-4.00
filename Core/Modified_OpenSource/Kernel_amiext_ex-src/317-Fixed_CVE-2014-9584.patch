--- linux_patch307/fs/isofs/rock.c	2020-03-30 10:43:00.185132669 +0800
+++ linux/fs/isofs/rock.c	2020-03-31 16:15:38.939365300 +0800
@@ -369,6 +369,9 @@
 			rs.cont_size = isonum_733(rr->u.CE.size);
 			break;
 		case SIG('E', 'R'):
+			/* Invalid length of ER tag id? */
+			if (rr->u.ER.len_id + offsetof(struct rock_ridge, u.ER.data) > rr->len)
+				goto out;
 			ISOFS_SB(inode->i_sb)->s_rock = 1;
 			printk(KERN_DEBUG "ISO 9660 Extensions: ");
 			{
