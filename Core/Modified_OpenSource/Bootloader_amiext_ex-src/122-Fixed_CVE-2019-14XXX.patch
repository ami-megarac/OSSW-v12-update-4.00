--- uboot.old/net/nfs.c	2020-11-04 18:38:42.736940783 -0500
+++ uboot/net/nfs.c	2020-11-04 15:25:20.941321423 -0500
@@ -495,6 +495,8 @@
 	    rpc_pkt.u.reply.astatus  ||
 	    rpc_pkt.u.reply.data[0])
 		return -1;
+	if (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + NFS_FHSIZE) > len)
+			return -NFS_RPC_DROP;
 
 	memcpy(filefh, rpc_pkt.u.reply.data + 1, NFS_FHSIZE);
 
@@ -524,6 +526,10 @@
 
 	rlen = ntohl(rpc_pkt.u.reply.data[1]); /* new path length */
 
+	if (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + rlen) > len)
+		return -NFS_RPC_DROP;
+
+
 	if (*((char *)&(rpc_pkt.u.reply.data[2])) != '/') {
 		int pathlen;
 		strcat(nfs_path, "/");
@@ -571,6 +577,10 @@
 		putc('#');
 
 	rlen = ntohl(rpc_pkt.u.reply.data[18]);
+
+	if (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + rlen) > len)
+			return -9999;
+
 	if (store_block((uchar *)pkt + sizeof(rpc_pkt.u.reply),
 			nfs_offset, rlen))
 		return -9999;
@@ -604,6 +614,9 @@
 
 	debug("%s\n", __func__);
 
+	if (len > sizeof(struct rpc_t))
+		return;
+
 	if (dest != NfsOurPort)
 		return;
 
