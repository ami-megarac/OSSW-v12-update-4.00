--- uboot_patch110/net/net.c	2020-04-14 15:42:18.708921151 +0800
+++ uboot/net/net.c	2020-04-14 17:30:48.330815929 +0800
@@ -1178,6 +1178,9 @@
 			return;
 		}
 
+		if (ntohs(ip->udp_len) < UDP_HDR_SIZE || ntohs(ip->udp_len) > ntohs(ip->ip_len))
+			return;
+
 		debug_cond(DEBUG_DEV_PKT,
 			"received UDP (to=%pI4, from=%pI4, len=%d)\n",
 			&dst_ip, &src_ip, len);
